<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Developer Toolbox - An integrated online developer toolbox with 15+ utilities including encoding conversion, data formatting, encryption hashing, QR code processing, regex tools, and more.">
  <meta name="keywords" content="dev tools,encoding,JSON formatter,regex,hash generator,QR code">
  <title>Developer Toolbox - Deng Anliang</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/assets/images/favicon.png">

  <!-- Stylesheets -->
  <link rel="stylesheet" href="/assets/css/themes.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/components.css">

  <!-- Alternate language -->
  <link rel="alternate" hreflang="en" href="/en/tools/dev-toolbox.html">
  <link rel="alternate" hreflang="zh" href="/tools/dev-toolbox.html">

  <style>
    .toolbox-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem 1rem;
    }

    .toolbox-header {
      text-align: center;
      margin-bottom: 3rem;
    }

    .toolbox-header h1 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
    }

    .toolbox-header p {
      color: var(--text-secondary);
      font-size: 1.1rem;
    }

    /* Tab Navigation */
    .tab-nav {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 2rem;
      border-bottom: 2px solid var(--border-color);
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    .tab-btn {
      background: transparent;
      border: none;
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      color: var(--text-secondary);
      cursor: pointer;
      border-bottom: 2px solid transparent;
      margin-bottom: -2px;
      white-space: nowrap;
      transition: all 0.3s ease;
    }

    .tab-btn:hover {
      color: var(--text-primary);
    }

    .tab-btn.active {
      color: var(--accent-color);
      border-bottom-color: var(--accent-color);
    }

    /* Tool Panels */
    .tool-panel {
      display: none;
    }

    .tool-panel.active {
      display: block;
    }

    /* Tool Cards */
    .tool-item {
      background: var(--card-bg);
      padding: 1.5rem;
      border-radius: 12px;
      border: 1px solid var(--border-color);
      margin-bottom: 1.5rem;
    }

    .tool-item h3 {
      margin-bottom: 1rem;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .tool-item h3 .icon {
      font-size: 1.3rem;
    }

    /* IO Groups */
    .io-group {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    @media (min-width: 768px) {
      .io-group.two-columns {
        grid-template-columns: 1fr 1fr;
      }
    }

    .io-section {
      display: flex;
      flex-direction: column;
    }

    .io-section label {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-bottom: 0.5rem;
      font-weight: 500;
    }

    .io-section textarea,
    .io-section input[type="text"],
    .io-section input[type="number"] {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 0.75rem;
      font-size: 0.95rem;
      color: var(--text-primary);
      font-family: 'Courier New', monospace;
      resize: vertical;
      min-height: 120px;
    }

    .io-section input[type="text"],
    .io-section input[type="number"] {
      min-height: auto;
    }

    .io-section select {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 0.75rem;
      font-size: 0.95rem;
      color: var(--text-primary);
      cursor: pointer;
    }

    /* Button Groups */
    .btn-group {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .btn {
      background: var(--accent-color);
      color: white;
      border: none;
      padding: 0.6rem 1.2rem;
      border-radius: 8px;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn:hover {
      opacity: 0.9;
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: var(--bg-secondary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }

    .btn-sm {
      padding: 0.4rem 0.8rem;
      font-size: 0.85rem;
    }

    /* Result Display */
    .result-box {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 0.75rem;
      font-family: 'Courier New', monospace;
      word-break: break-all;
      min-height: 60px;
      position: relative;
    }

    .result-box.with-copy {
      padding-right: 3rem;
    }

    .copy-btn {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: var(--accent-color);
      color: white;
      border: none;
      padding: 0.4rem 0.8rem;
      border-radius: 6px;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .copy-btn:hover {
      opacity: 0.9;
    }

    .copy-btn.copied {
      background: #10b981;
    }

    /* Hints */
    .hint {
      font-size: 0.85rem;
      color: var(--text-tertiary);
      margin-top: 0.5rem;
    }

    /* Error Messages */
    .error {
      color: #ef4444;
      font-size: 0.9rem;
      margin-top: 0.5rem;
    }

    /* QR Code Display */
    .qr-display {
      text-align: center;
      padding: 1rem;
    }

    .qr-display canvas {
      max-width: 100%;
      border: 1px solid var(--border-color);
      border-radius: 8px;
    }

    /* Color Preview */
    .color-preview {
      width: 100%;
      height: 80px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      margin-bottom: 1rem;
    }

    /* Regex Highlight */
    .regex-highlight {
      background: #fef3c7;
      color: #92400e;
    }

    [data-theme="dark"] .regex-highlight {
      background: #78350f;
      color: #fef3c7;
    }

    /* Text Diff */
    .diff-line {
      padding: 0.25rem 0.5rem;
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
    }

    .diff-add {
      background: #d1fae5;
      color: #065f46;
    }

    .diff-remove {
      background: #fee2e2;
      color: #991b1b;
    }

    [data-theme="dark"] .diff-add {
      background: #064e3b;
      color: #d1fae5;
    }

    [data-theme="dark"] .diff-remove {
      background: #7f1d1d;
      color: #fee2e2;
    }

    /* File Upload Area */
    .file-upload {
      border: 2px dashed var(--border-color);
      border-radius: 8px;
      padding: 2rem;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .file-upload:hover {
      border-color: var(--accent-color);
      background: var(--bg-secondary);
    }

    .file-upload input[type="file"] {
      display: none;
    }

    /* Sub Navigation */
    .sub-nav {
      position: sticky;
      top: 60px;
      background: var(--bg-primary);
      padding: 1rem 0;
      margin-bottom: 2rem;
      border-bottom: 1px solid var(--border-color);
      z-index: 100;
    }

    .sub-nav-list {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      justify-content: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .sub-nav-item {
      background: var(--bg-secondary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-size: 0.9rem;
      text-decoration: none;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .sub-nav-item:hover {
      background: var(--accent-color);
      color: white;
      border-color: var(--accent-color);
      transform: translateY(-2px);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .toolbox-header h1 {
        font-size: 2rem;
      }

      .tab-nav {
        justify-content: flex-start;
      }

      .tool-item {
        padding: 1rem;
      }

      .sub-nav {
        top: 50px;
      }

      .sub-nav-list {
        justify-content: flex-start;
        overflow-x: auto;
        flex-wrap: nowrap;
        -webkit-overflow-scrolling: touch;
      }

      .sub-nav-item {
        white-space: nowrap;
      }
    }
  </style>
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="navbar-content">
      <a href="/en/" class="navbar-logo">Deng Anliang</a>

      <ul class="navbar-menu">
        <li><a href="/en/">Home</a></li>
        <li><a href="/en/about/">About</a></li>
        <li><a href="/en/projects/">Projects</a></li>
        <li><a href="/en/tools/">Tools</a></li>
        <li><a href="/en/blog/">Blog</a></li>
      </ul>

      <div class="navbar-actions">
        <button class="lang-toggle" aria-label="Switch Language">‰∏≠Êñá</button>
        <button class="theme-toggle" aria-label="Toggle Theme"></button>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content">
    <div class="toolbox-container">
      <!-- Page Header -->
      <div class="toolbox-header">
        <h1>üß∞ Developer Toolbox</h1>
        <p>15+ integrated developer utilities, pure front-end implementation, your data stays secure</p>
      </div>

      <!-- Tab Navigation -->
      <div class="tab-nav">
        <button class="tab-btn active" data-tab="text-tools">Text Tools</button>
        <button class="tab-btn" data-tab="data-tools">Data Tools</button>
        <button class="tab-btn" data-tab="crypto-tools">Crypto Tools</button>
        <button class="tab-btn" data-tab="dev-tools">Dev Tools</button>
      </div>

      <!-- Sub Navigation -->
      <nav class="sub-nav">
        <div class="sub-nav-list">
          <a href="#base64" class="sub-nav-item">Base64</a>
          <a href="#url-encode" class="sub-nav-item">URL</a>
          <a href="#html-entity" class="sub-nav-item">HTML Entity</a>
          <a href="#unicode" class="sub-nav-item">Unicode</a>
          <a href="#text-diff" class="sub-nav-item">Text Diff</a>
          <a href="#json" class="sub-nav-item">JSON</a>
          <a href="#jwt" class="sub-nav-item">JWT</a>
          <a href="#uuid" class="sub-nav-item">UUID</a>
          <a href="#timestamp" class="sub-nav-item">Timestamp</a>
          <a href="#hash" class="sub-nav-item">Hash</a>
          <a href="#qr-gen" class="sub-nav-item">QR Gen</a>
          <a href="#qr-decode" class="sub-nav-item">QR Decode</a>
          <a href="#regex" class="sub-nav-item">Regex</a>
          <a href="#color" class="sub-nav-item">Color</a>
          <a href="#base-convert" class="sub-nav-item">Base Convert</a>
        </div>
      </nav>

      <!-- Text Tools Panel -->
      <div class="tool-panel active" id="text-tools">
        <!-- Base64 Encode/Decode -->
        <div class="tool-item" id="base64">
          <h3><span class="icon">üî§</span> Base64 Encode/Decode</h3>
          <div class="io-group two-columns">
            <div class="io-section">
              <label>Original Text</label>
              <textarea id="base64-input" placeholder="Enter text to encode"></textarea>
            </div>
            <div class="io-section">
              <label>Base64 Result</label>
              <textarea id="base64-output" placeholder="Encoded result" readonly></textarea>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn" onclick="encodeBase64()">Encode</button>
            <button class="btn btn-secondary" onclick="decodeBase64()">Decode</button>
            <button class="btn btn-secondary" onclick="clearBase64()">Clear</button>
            <button class="btn btn-secondary" onclick="swapBase64()">Swap</button>
          </div>
        </div>

        <!-- URL Encode/Decode -->
        <div class="tool-item" id="url-encode">
          <h3><span class="icon">üîó</span> URL Encode/Decode</h3>
          <div class="io-group two-columns">
            <div class="io-section">
              <label>Original Text</label>
              <textarea id="url-input" placeholder="Enter URL or text to encode"></textarea>
            </div>
            <div class="io-section">
              <label>Encoded Result</label>
              <textarea id="url-output" placeholder="Encoded result" readonly></textarea>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn" onclick="encodeURL()">Encode</button>
            <button class="btn btn-secondary" onclick="decodeURL()">Decode</button>
            <button class="btn btn-secondary" onclick="clearURL()">Clear</button>
          </div>
        </div>

        <!-- HTML Entity Conversion -->
        <div class="tool-item" id="html-entity">
          <h3><span class="icon">üìù</span> HTML Entity Conversion</h3>
          <div class="io-group two-columns">
            <div class="io-section">
              <label>Original Text</label>
              <textarea id="html-input" placeholder='Enter HTML text, e.g.: <div>Hello</div>'></textarea>
            </div>
            <div class="io-section">
              <label>Converted Result</label>
              <textarea id="html-output" placeholder="Converted result" readonly></textarea>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn" onclick="encodeHTML()">Encode</button>
            <button class="btn btn-secondary" onclick="decodeHTML()">Decode</button>
            <button class="btn btn-secondary" onclick="clearHTML()">Clear</button>
          </div>
        </div>

        <!-- Unicode Conversion -->
        <div class="tool-item" id="unicode">
          <h3><span class="icon">üàØ</span> Unicode Conversion</h3>
          <div class="io-group two-columns">
            <div class="io-section">
              <label>Original Text</label>
              <textarea id="unicode-input" placeholder="Enter text or Unicode encoding"></textarea>
            </div>
            <div class="io-section">
              <label>Converted Result</label>
              <textarea id="unicode-output" placeholder="Converted result" readonly></textarea>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn" onclick="textToUnicode()">Text‚ÜíUnicode</button>
            <button class="btn btn-secondary" onclick="unicodeToText()">Unicode‚ÜíText</button>
            <button class="btn btn-secondary" onclick="clearUnicode()">Clear</button>
          </div>
        </div>

        <!-- Text Diff -->
        <div class="tool-item" id="text-diff">
          <h3><span class="icon">üìä</span> Text Diff</h3>
          <div class="io-group two-columns">
            <div class="io-section">
              <label>Text 1</label>
              <textarea id="diff-text1" placeholder="Enter first text"></textarea>
            </div>
            <div class="io-section">
              <label>Text 2</label>
              <textarea id="diff-text2" placeholder="Enter second text"></textarea>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn" onclick="compareDiff()">Compare</button>
            <button class="btn btn-secondary" onclick="clearDiff()">Clear</button>
          </div>
          <div id="diff-result" style="margin-top: 1rem;"></div>
        </div>
      </div>

      <!-- Data Tools Panel -->
      <div class="tool-panel" id="data-tools">
        <!-- JSON Formatter -->
        <div class="tool-item">
          <h3><span class="icon">{ }</span> JSON Formatter</h3>
          <div class="io-group">
            <div class="io-section">
              <label>Input JSON</label>
              <textarea id="json-input" placeholder='{"name":"value"}' style="min-height: 200px;"></textarea>
            </div>
            <div class="io-section">
              <label>Formatted Result</label>
              <textarea id="json-output" placeholder="Formatted JSON" readonly style="min-height: 200px;"></textarea>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn" onclick="formatJSON()">Format</button>
            <button class="btn btn-secondary" onclick="compressJSON()">Compress</button>
            <button class="btn btn-secondary" onclick="clearJSON()">Clear</button>
          </div>
          <div id="json-error" class="error"></div>
        </div>

        <!-- JWT Parser -->
        <div class="tool-item">
          <h3><span class="icon">üîê</span> JWT Parser</h3>
          <div class="io-group">
            <div class="io-section">
              <label>JWT Token</label>
              <textarea id="jwt-input" placeholder="Paste JWT token"></textarea>
            </div>
            <div class="io-section">
              <label>Parsed Result</label>
              <textarea id="jwt-output" placeholder="Parsed JSON" readonly style="min-height: 200px;"></textarea>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn" onclick="parseJWT()">Parse</button>
            <button class="btn btn-secondary" onclick="clearJWT()">Clear</button>
          </div>
          <div id="jwt-error" class="error"></div>
        </div>

        <!-- UUID Generator -->
        <div class="tool-item">
          <h3><span class="icon">üÜî</span> UUID Generator</h3>
          <div class="io-group">
            <div class="io-section">
              <label>Count</label>
              <input type="number" id="uuid-count" value="1" min="1" max="100">
            </div>
            <div class="io-section">
              <label>Generated UUIDs</label>
              <textarea id="uuid-output" placeholder="Click generate button" readonly></textarea>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn" onclick="generateUUID()">Generate UUID</button>
            <button class="btn btn-secondary" onclick="clearUUID()">Clear</button>
          </div>
        </div>

        <!-- Timestamp Converter -->
        <div class="tool-item">
          <h3><span class="icon">‚è∞</span> Timestamp Converter</h3>

          <!-- Current Time Display -->
          <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
            <div style="margin-bottom: 0.75rem;">
              <label style="display: block; margin-bottom: 0.25rem; font-size: 0.85rem; color: var(--text-secondary);">Current DateTime String</label>
              <div class="result-box with-copy">
                <span id="current-datetime-str" style="font-size: 0.9rem;">-</span>
                <button class="copy-btn btn-sm" onclick="copyCurrentDateStr()">Copy</button>
              </div>
            </div>
            <div class="io-group two-columns">
              <div style="margin-bottom: 0;">
                <label style="display: block; margin-bottom: 0.25rem; font-size: 0.85rem; color: var(--text-secondary);">Timestamp (ms)</label>
                <div class="result-box with-copy">
                  <span id="current-timestamp-ms">0</span>
                  <button class="copy-btn btn-sm" onclick="copyText(document.getElementById('current-timestamp-ms').textContent, event.target)">Copy</button>
                </div>
              </div>
              <div style="margin-bottom: 0;">
                <label style="display: block; margin-bottom: 0.25rem; font-size: 0.85rem; color: var(--text-secondary);">Timestamp (s)</label>
                <div class="result-box with-copy">
                  <span id="current-timestamp-s">0</span>
                  <button class="copy-btn btn-sm" onclick="copyText(document.getElementById('current-timestamp-s').textContent, event.target)">Copy</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Timestamp to Date -->
          <div style="margin-bottom: 1.5rem;">
            <label style="font-weight: 600; margin-bottom: 0.5rem; display: block;">Timestamp ‚Üí Date</label>
            <div class="io-group two-columns">
              <div class="io-section">
                <input type="number" id="timestamp-input" placeholder="Enter timestamp (ms or s)">
              </div>
              <div class="io-section">
                <div class="btn-group">
                  <button class="btn" onclick="timestampToDate()">Convert</button>
                  <button class="btn btn-secondary btn-sm" onclick="useCurrentTimestamp()">Use Current</button>
                </div>
              </div>
            </div>
            <div id="timestamp-result" style="margin-top: 0.75rem;"></div>
          </div>

          <!-- Date to Timestamp -->
          <div style="margin-bottom: 1.5rem;">
            <label style="font-weight: 600; margin-bottom: 0.5rem; display: block;">Date ‚Üí Timestamp</label>
            <div class="io-group">
              <div class="io-section">
                <label>Select DateTime</label>
                <input type="datetime-local" id="datetime-input">
              </div>
              <div class="io-section">
                <label>Or Enter Date String</label>
                <input type="text" id="datestr-input" placeholder="e.g: 2024-01-01 12:00:00">
              </div>
            </div>
            <div class="btn-group" style="margin-top: 0.5rem;">
              <button class="btn" onclick="dateToTimestamp()">Convert</button>
              <button class="btn btn-secondary" onclick="clearDateInput()">Clear</button>
            </div>
            <div id="date-result" style="margin-top: 0.75rem;"></div>
          </div>

          <!-- Time Difference Calculator -->
          <div style="border-top: 1px solid var(--border-color); padding-top: 1.5rem;">
            <label style="font-weight: 600; margin-bottom: 0.5rem; display: block;">‚è±Ô∏è Time Difference Calculator</label>
            <div class="io-group two-columns">
              <div class="io-section">
                <label>Start Time</label>
                <input type="datetime-local" id="diff-start">
                <input type="number" id="diff-start-ts" placeholder="Or enter timestamp" style="margin-top: 0.5rem;">
              </div>
              <div class="io-section">
                <label>End Time</label>
                <input type="datetime-local" id="diff-end">
                <input type="number" id="diff-end-ts" placeholder="Or enter timestamp" style="margin-top: 0.5rem;">
              </div>
            </div>
            <div class="btn-group" style="margin-top: 0.5rem;">
              <button class="btn" onclick="calculateTimeDiff()">Calculate</button>
              <button class="btn btn-secondary" onclick="clearTimeDiff()">Clear</button>
            </div>
            <div id="diff-result" style="margin-top: 0.75rem;"></div>
          </div>
        </div>
      </div>

      <!-- Crypto Tools Panel -->
      <div class="tool-panel" id="crypto-tools">
        <!-- Hash Generator -->
        <div class="tool-item">
          <h3><span class="icon">üîí</span> Hash Generator</h3>
          <div class="io-group">
            <div class="io-section">
              <label>Input Text</label>
              <textarea id="hash-input" placeholder="Enter text to hash"></textarea>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn" onclick="generateHash('MD5')">MD5</button>
            <button class="btn btn-secondary" onclick="generateHash('SHA-1')">SHA-1</button>
            <button class="btn btn-secondary" onclick="generateHash('SHA-256')">SHA-256</button>
            <button class="btn btn-secondary" onclick="generateHash('SHA-512')">SHA-512</button>
            <button class="btn btn-secondary" onclick="clearHash()">Clear</button>
          </div>
          <div id="hash-results" style="margin-top: 1rem;"></div>
        </div>

        <!-- QR Code Generator -->
        <div class="tool-item">
          <h3><span class="icon">üì±</span> QR Code Generator</h3>
          <div class="io-group">
            <div class="io-section">
              <label>Input Text or URL</label>
              <textarea id="qr-text" placeholder="Enter content to generate QR code"></textarea>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn" onclick="generateQRCode()">Generate QR Code</button>
            <button class="btn btn-secondary" onclick="downloadQR()">Download Image</button>
            <button class="btn btn-secondary" onclick="clearQR()">Clear</button>
          </div>
          <div class="qr-display">
            <canvas id="qr-canvas"></canvas>
          </div>
        </div>

        <!-- QR Code Decoder -->
        <div class="tool-item">
          <h3><span class="icon">üì∑</span> QR Code Decoder</h3>
          <div class="file-upload" onclick="document.getElementById('qr-file').click()">
            <input type="file" id="qr-file" accept="image/*" onchange="decodeQRCode(event)">
            <p>Click or drag image here</p>
            <p class="hint">Supports JPG, PNG format QR code images</p>
          </div>
          <div id="qr-decode-result" style="margin-top: 1rem;"></div>
        </div>
      </div>

      <!-- Dev Tools Panel -->
      <div class="tool-panel" id="dev-tools">
        <!-- Regular Expression Tester -->
        <div class="tool-item">
          <h3><span class="icon">üîç</span> Regular Expression Tester</h3>
          <div class="io-group">
            <div class="io-section">
              <label>Regular Expression</label>
              <input type="text" id="regex-pattern" placeholder="Enter regex pattern, e.g.: \d+">
              <div style="margin-top: 0.5rem;">
                <label style="display: inline-flex; align-items: center; margin-right: 1rem;">
                  <input type="checkbox" id="regex-flag-g" checked> g (global)
                </label>
                <label style="display: inline-flex; align-items: center; margin-right: 1rem;">
                  <input type="checkbox" id="regex-flag-i"> i (ignore case)
                </label>
                <label style="display: inline-flex; align-items: center;">
                  <input type="checkbox" id="regex-flag-m"> m (multiline)
                </label>
              </div>
            </div>
            <div class="io-section">
              <label>Test Text</label>
              <textarea id="regex-text" placeholder="Enter text to test"></textarea>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn" onclick="testRegex()">Test Match</button>
            <button class="btn btn-secondary" onclick="regexReplace()">Replace</button>
            <button class="btn btn-secondary" onclick="clearRegex()">Clear</button>
          </div>
          <div class="io-group" style="margin-top: 1rem;">
            <div class="io-section">
              <label>Common Regex Library</label>
              <select id="regex-presets" onchange="applyRegexPreset()">
                <option value="">Select a common regex...</option>
                <option value="email">Email Address</option>
                <option value="phone">Phone Number (China)</option>
                <option value="url">URL</option>
                <option value="ip">IP Address</option>
                <option value="date">Date (YYYY-MM-DD)</option>
                <option value="number">Number</option>
                <option value="hex">Hex Color</option>
                <option value="chinese">Chinese Characters</option>
              </select>
            </div>
          </div>
          <div id="regex-result" style="margin-top: 1rem;"></div>
        </div>

        <!-- Color Converter -->
        <div class="tool-item">
          <h3><span class="icon">üé®</span> Color Converter</h3>
          <div class="color-preview" id="color-preview"></div>
          <div class="io-group">
            <div class="io-section">
              <label>HEX</label>
              <input type="text" id="color-hex" placeholder="#FF5733" onchange="convertFromHex()">
            </div>
            <div class="io-section">
              <label>RGB</label>
              <input type="text" id="color-rgb" placeholder="rgb(255, 87, 51)" onchange="convertFromRGB()">
            </div>
            <div class="io-section">
              <label>HSL</label>
              <input type="text" id="color-hsl" placeholder="hsl(9, 100%, 60%)" onchange="convertFromHSL()">
            </div>
          </div>
          <div class="btn-group">
            <button class="btn btn-secondary" onclick="clearColor()">Clear</button>
          </div>
        </div>

        <!-- Base Converter -->
        <div class="tool-item">
          <h3><span class="icon">üî¢</span> Base Converter</h3>
          <div class="io-group">
            <div class="io-section">
              <label>Input Number</label>
              <input type="text" id="base-input" placeholder="Enter number">
              <select id="base-from" style="margin-top: 0.5rem;">
                <option value="10">Decimal</option>
                <option value="2">Binary</option>
                <option value="8">Octal</option>
                <option value="16">Hexadecimal</option>
              </select>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn" onclick="convertBase()">Convert</button>
            <button class="btn btn-secondary" onclick="clearBase()">Clear</button>
          </div>
          <div id="base-results" style="margin-top: 1rem;"></div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-social">
        <a href="mailto:i@denganliang.com" aria-label="Email">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
            <path d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555ZM0 4.697v7.104l5.803-3.558L0 4.697ZM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757Zm3.436-.586L16 11.801V4.697l-5.803 3.546Z"/>
          </svg>
        </a>
        <a href="https://github.com/denganliang" target="_blank" rel="noopener" aria-label="GitHub">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
          </svg>
        </a>
        <a href="https://twitter.com/denganliang" target="_blank" rel="noopener" aria-label="Twitter">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
            <path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"/>
          </svg>
        </a>
      </div>

      <ul class="footer-links">
        <li><a href="/en/about/">About</a></li>
        <li><a href="/en/blog/">Blog</a></li>
        <li><a href="/en/projects/">Projects</a></li>
        <li><a href="/en/tools/">Tools</a></li>
      </ul>

      <p style="margin-bottom: 0.5rem;">Contact: <a href="mailto:i@denganliang.com">i@denganliang.com</a></p>
      <p>&copy; 2026 Deng Anliang. All rights reserved.</p>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="/assets/js/theme-switcher.js"></script>
  <script src="/assets/js/i18n.js"></script>
  <script src="/assets/js/main.js"></script>

  <script>
    // Same JavaScript code as Chinese version (using same IDs and logic)
    // ==================== Tab Navigation ====================
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tool-panel').forEach(p => p.classList.remove('active'));

        btn.classList.add('active');
        document.getElementById(btn.dataset.tab).classList.add('active');

        localStorage.setItem('dev-toolbox-tab', btn.dataset.tab);
      });
    });

    const savedTab = localStorage.getItem('dev-toolbox-tab');
    if (savedTab) {
      const btn = document.querySelector(`[data-tab="${savedTab}"]`);
      if (btn) btn.click();
    }

    // ==================== Common Copy Function ====================
    async function copyToClipboard(text, button) {
      try {
        await navigator.clipboard.writeText(text);
        if (button) {
          const originalText = button.textContent;
          button.textContent = 'Copied';
          button.classList.add('copied');
          setTimeout(() => {
            button.textContent = originalText;
            button.classList.remove('copied');
          }, 2000);
        }
      } catch (err) {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
      }
    }

    // ==================== Base64 Tool ====================
    function encodeBase64() {
      const input = document.getElementById('base64-input').value;
      try {
        const encoded = btoa(unescape(encodeURIComponent(input)));
        document.getElementById('base64-output').value = encoded;
      } catch (e) {
        alert('Encoding failed: ' + e.message);
      }
    }

    function decodeBase64() {
      const input = document.getElementById('base64-input').value;
      try {
        const decoded = decodeURIComponent(escape(atob(input)));
        document.getElementById('base64-output').value = decoded;
      } catch (e) {
        alert('Decoding failed, please ensure the input is valid Base64');
      }
    }

    function clearBase64() {
      document.getElementById('base64-input').value = '';
      document.getElementById('base64-output').value = '';
    }

    function swapBase64() {
      const input = document.getElementById('base64-input');
      const output = document.getElementById('base64-output');
      [input.value, output.value] = [output.value, input.value];
    }

    // ==================== URL Encode/Decode ====================
    function encodeURL() {
      const input = document.getElementById('url-input').value;
      document.getElementById('url-output').value = encodeURIComponent(input);
    }

    function decodeURL() {
      const input = document.getElementById('url-input').value;
      try {
        document.getElementById('url-output').value = decodeURIComponent(input);
      } catch (e) {
        alert('Decoding failed, please ensure the input is valid URL encoding');
      }
    }

    function clearURL() {
      document.getElementById('url-input').value = '';
      document.getElementById('url-output').value = '';
    }

    // ==================== HTML Entity Conversion ====================
    function encodeHTML() {
      const input = document.getElementById('html-input').value;
      const div = document.createElement('div');
      div.textContent = input;
      document.getElementById('html-output').value = div.innerHTML;
    }

    function decodeHTML() {
      const input = document.getElementById('html-input').value;
      const div = document.createElement('div');
      div.innerHTML = input;
      document.getElementById('html-output').value = div.textContent;
    }

    function clearHTML() {
      document.getElementById('html-input').value = '';
      document.getElementById('html-output').value = '';
    }

    // ==================== Unicode Conversion ====================
    function textToUnicode() {
      const input = document.getElementById('unicode-input').value;
      let result = '';
      for (let i = 0; i < input.length; i++) {
        result += '\\u' + input.charCodeAt(i).toString(16).padStart(4, '0');
      }
      document.getElementById('unicode-output').value = result;
    }

    function unicodeToText() {
      const input = document.getElementById('unicode-input').value;
      try {
        const result = input.replace(/\\u[\dA-Fa-f]{4}/g, match =>
          String.fromCharCode(parseInt(match.replace(/\\u/g, ''), 16))
        );
        document.getElementById('unicode-output').value = result;
      } catch (e) {
        alert('Conversion failed, please ensure the input is valid Unicode');
      }
    }

    function clearUnicode() {
      document.getElementById('unicode-input').value = '';
      document.getElementById('unicode-output').value = '';
    }

    // ==================== Text Diff ====================
    function compareDiff() {
      const text1 = document.getElementById('diff-text1').value.split('\n');
      const text2 = document.getElementById('diff-text2').value.split('\n');
      const result = document.getElementById('diff-result');

      let html = '<div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px;">';

      const maxLen = Math.max(text1.length, text2.length);
      for (let i = 0; i < maxLen; i++) {
        const line1 = text1[i] || '';
        const line2 = text2[i] || '';

        if (line1 !== line2) {
          if (line1) html += `<div class="diff-line diff-remove">- ${escapeHTML(line1)}</div>`;
          if (line2) html += `<div class="diff-line diff-add">+ ${escapeHTML(line2)}</div>`;
        } else {
          html += `<div class="diff-line">  ${escapeHTML(line1)}</div>`;
        }
      }

      html += '</div>';
      result.innerHTML = html;
    }

    function clearDiff() {
      document.getElementById('diff-text1').value = '';
      document.getElementById('diff-text2').value = '';
      document.getElementById('diff-result').innerHTML = '';
    }

    function escapeHTML(str) {
      const div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }

    // ==================== JSON Tool ====================
    function formatJSON() {
      const input = document.getElementById('json-input').value;
      const errorDiv = document.getElementById('json-error');
      try {
        const obj = JSON.parse(input);
        document.getElementById('json-output').value = JSON.stringify(obj, null, 2);
        errorDiv.textContent = '';
      } catch (e) {
        errorDiv.textContent = 'Error: ' + e.message;
      }
    }

    function compressJSON() {
      const input = document.getElementById('json-input').value;
      const errorDiv = document.getElementById('json-error');
      try {
        const obj = JSON.parse(input);
        document.getElementById('json-output').value = JSON.stringify(obj);
        errorDiv.textContent = '';
      } catch (e) {
        errorDiv.textContent = 'Error: ' + e.message;
      }
    }

    function clearJSON() {
      document.getElementById('json-input').value = '';
      document.getElementById('json-output').value = '';
      document.getElementById('json-error').textContent = '';
    }

    // ==================== JWT Parser ====================
    function parseJWT() {
      const input = document.getElementById('jwt-input').value.trim();
      const errorDiv = document.getElementById('jwt-error');
      try {
        const parts = input.split('.');
        if (parts.length !== 3) throw new Error('Invalid JWT format');

        const header = JSON.parse(atob(parts[0]));
        const payload = JSON.parse(atob(parts[1]));

        const result = {
          header,
          payload,
          signature: parts[2]
        };

        document.getElementById('jwt-output').value = JSON.stringify(result, null, 2);
        errorDiv.textContent = '';
      } catch (e) {
        errorDiv.textContent = 'Error: ' + e.message;
      }
    }

    function clearJWT() {
      document.getElementById('jwt-input').value = '';
      document.getElementById('jwt-output').value = '';
      document.getElementById('jwt-error').textContent = '';
    }

    // ==================== UUID Generator ====================
    function generateUUID() {
      const count = parseInt(document.getElementById('uuid-count').value) || 1;
      const uuids = [];

      for (let i = 0; i < count; i++) {
        if (typeof crypto.randomUUID === 'function') {
          uuids.push(crypto.randomUUID());
        } else {
          uuids.push('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {
            const r = Math.random() * 16 | 0;
            const v = c === 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
          }));
        }
      }

      document.getElementById('uuid-output').value = uuids.join('\n');
    }

    function clearUUID() {
      document.getElementById('uuid-output').value = '';
    }

    // ==================== Timestamp Tool ====================
    // Update current time display
    function updateCurrentTimestamp() {
      const now = Date.now();
      const nowDate = new Date(now);

      document.getElementById('current-timestamp-ms').textContent = now;
      document.getElementById('current-timestamp-s').textContent = Math.floor(now / 1000);
      document.getElementById('current-datetime-str').textContent = nowDate.toLocaleString('en-US', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: false
      });
    }

    setInterval(updateCurrentTimestamp, 1000);
    updateCurrentTimestamp();

    // Copy current date string
    function copyCurrentDateStr() {
      const text = document.getElementById('current-datetime-str').textContent;
      copyToClipboard(text, event.target);
    }

    // Generic copy text function
    function copyText(text, button) {
      copyToClipboard(text, button);
    }

    // Use current timestamp
    function useCurrentTimestamp() {
      document.getElementById('timestamp-input').value = Date.now();
      timestampToDate();
    }

    // Timestamp to date
    function timestampToDate() {
      let timestamp = parseInt(document.getElementById('timestamp-input').value);
      const result = document.getElementById('timestamp-result');

      if (isNaN(timestamp)) {
        result.innerHTML = '<div class="error">Please enter a valid timestamp</div>';
        return;
      }

      // Auto-detect 10-digit (seconds) and 13-digit (milliseconds) timestamps
      if (timestamp.toString().length === 10) {
        timestamp = timestamp * 1000;
      }

      const date = new Date(timestamp);

      if (isNaN(date.getTime())) {
        result.innerHTML = '<div class="error">Invalid timestamp</div>';
        return;
      }

      result.innerHTML = `
        <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; position: relative; padding-right: 4rem;">
          <strong>Local Time:</strong> ${date.toLocaleString('en-US')}<br>
          <strong>UTC Time:</strong> ${date.toUTCString()}<br>
          <strong>ISO Format:</strong> ${date.toISOString()}<br>
          <strong>Date:</strong> ${date.toLocaleDateString('en-US')}<br>
          <strong>Time:</strong> ${date.toLocaleTimeString('en-US')}
          <button class="copy-btn" onclick="copyText('${date.toLocaleString('en-US')}', this)">Copy</button>
        </div>
      `;
    }

    // Date to timestamp
    function dateToTimestamp() {
      const datetimeInput = document.getElementById('datetime-input').value;
      const datestrInput = document.getElementById('datestr-input').value.trim();
      const result = document.getElementById('date-result');

      let timestamp;

      if (datestrInput) {
        // Prefer string input
        const date = new Date(datestrInput);
        if (isNaN(date.getTime())) {
          result.innerHTML = '<div class="error">Invalid date format, please use format like "2024-01-01 12:00:00"</div>';
          return;
        }
        timestamp = date.getTime();
      } else if (datetimeInput) {
        // Use datetime-local input
        timestamp = new Date(datetimeInput).getTime();
      } else {
        result.innerHTML = '<div class="error">Please select date time or enter date string</div>';
        return;
      }

      result.innerHTML = `
        <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
          <div style="margin-bottom: 0.5rem;">
            <strong>Timestamp (ms):</strong>
            <code style="margin-left: 0.5rem;">${timestamp}</code>
            <button class="btn btn-sm" style="margin-left: 0.5rem;" onclick="copyText('${timestamp}', this)">Copy</button>
          </div>
          <div>
            <strong>Timestamp (s):</strong>
            <code style="margin-left: 0.5rem;">${Math.floor(timestamp / 1000)}</code>
            <button class="btn btn-sm" style="margin-left: 0.5rem;" onclick="copyText('${Math.floor(timestamp / 1000)}', this)">Copy</button>
          </div>
        </div>
      `;
    }

    // Clear date input
    function clearDateInput() {
      document.getElementById('datetime-input').value = '';
      document.getElementById('datestr-input').value = '';
      document.getElementById('date-result').innerHTML = '';
    }

    // Calculate time difference
    function calculateTimeDiff() {
      const startDate = document.getElementById('diff-start').value;
      const endDate = document.getElementById('diff-end').value;
      let startTs = parseInt(document.getElementById('diff-start-ts').value);
      let endTs = parseInt(document.getElementById('diff-end-ts').value);
      const result = document.getElementById('diff-result');

      // Determine start time
      let startTime;
      if (!isNaN(startTs)) {
        // Auto-detect seconds/milliseconds
        if (startTs.toString().length === 10) startTs *= 1000;
        startTime = startTs;
      } else if (startDate) {
        startTime = new Date(startDate).getTime();
      } else {
        result.innerHTML = '<div class="error">Please enter start time</div>';
        return;
      }

      // Determine end time
      let endTime;
      if (!isNaN(endTs)) {
        // Auto-detect seconds/milliseconds
        if (endTs.toString().length === 10) endTs *= 1000;
        endTime = endTs;
      } else if (endDate) {
        endTime = new Date(endDate).getTime();
      } else {
        result.innerHTML = '<div class="error">Please enter end time</div>';
        return;
      }

      // Calculate difference
      const diff = Math.abs(endTime - startTime);
      const isNegative = endTime < startTime;

      const seconds = Math.floor(diff / 1000);
      const minutes = Math.floor(seconds / 60);
      const hours = Math.floor(minutes / 60);
      const days = Math.floor(hours / 24);

      const remainSeconds = seconds % 60;
      const remainMinutes = minutes % 60;
      const remainHours = hours % 24;

      result.innerHTML = `
        <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
          <div style="font-size: 1.1rem; margin-bottom: 0.75rem; color: var(--accent-color); font-weight: 600;">
            ${isNegative ? '‚¨ÖÔ∏è ' : '‚û°Ô∏è '} Time Difference
          </div>
          <div style="margin-bottom: 0.5rem;"><strong>Total Milliseconds:</strong> ${diff.toLocaleString()} ms</div>
          <div style="margin-bottom: 0.5rem;"><strong>Total Seconds:</strong> ${seconds.toLocaleString()} seconds</div>
          <div style="margin-bottom: 0.5rem;"><strong>Total Minutes:</strong> ${minutes.toLocaleString()} minutes</div>
          <div style="margin-bottom: 0.5rem;"><strong>Total Hours:</strong> ${hours.toLocaleString()} hours</div>
          <div style="margin-bottom: 0.75rem;"><strong>Total Days:</strong> ${days.toLocaleString()} days</div>
          <div style="padding-top: 0.75rem; border-top: 1px solid var(--border-color);">
            <strong>Detailed Difference:</strong>
            ${days > 0 ? `${days} days ` : ''}${remainHours} hours ${remainMinutes} minutes ${remainSeconds} seconds
          </div>
          ${isNegative ? '<div style="margin-top: 0.5rem; color: var(--text-secondary); font-size: 0.85rem;">Note: End time is earlier than start time</div>' : ''}
        </div>
      `;
    }

    // Clear time difference
    function clearTimeDiff() {
      document.getElementById('diff-start').value = '';
      document.getElementById('diff-end').value = '';
      document.getElementById('diff-start-ts').value = '';
      document.getElementById('diff-end-ts').value = '';
      document.getElementById('diff-result').innerHTML = '';
    }

    // ==================== Hash Generator ====================
    // MD5 Algorithm Implementation (simplified version) - Same as Chinese version
    function MD5(string) {
      function rotateLeft(value, shift) {
        return (value << shift) | (value >>> (32 - shift));
      }

      function addUnsigned(x, y) {
        const lsw = (x & 0xFFFF) + (y & 0xFFFF);
        const msw = (x >> 16) + (y >> 16) + (lsw >> 16);
        return (msw << 16) | (lsw & 0xFFFF);
      }

      function F(x, y, z) { return (x & y) | ((~x) & z); }
      function G(x, y, z) { return (x & z) | (y & (~z)); }
      function H(x, y, z) { return x ^ y ^ z; }
      function I(x, y, z) { return y ^ (x | (~z)); }

      function FF(a, b, c, d, x, s, ac) {
        a = addUnsigned(a, addUnsigned(addUnsigned(F(b, c, d), x), ac));
        return addUnsigned(rotateLeft(a, s), b);
      }

      function GG(a, b, c, d, x, s, ac) {
        a = addUnsigned(a, addUnsigned(addUnsigned(G(b, c, d), x), ac));
        return addUnsigned(rotateLeft(a, s), b);
      }

      function HH(a, b, c, d, x, s, ac) {
        a = addUnsigned(a, addUnsigned(addUnsigned(H(b, c, d), x), ac));
        return addUnsigned(rotateLeft(a, s), b);
      }

      function II(a, b, c, d, x, s, ac) {
        a = addUnsigned(a, addUnsigned(addUnsigned(I(b, c, d), x), ac));
        return addUnsigned(rotateLeft(a, s), b);
      }

      function convertToWordArray(string) {
        let wordArray = [];
        for (let i = 0; i < string.length * 8; i += 8) {
          wordArray[i >> 5] |= (string.charCodeAt(i / 8) & 0xFF) << (i % 32);
        }
        return wordArray;
      }

      function utf8Encode(string) {
        string = string.replace(/\r\n/g, "\n");
        let utftext = "";
        for (let n = 0; n < string.length; n++) {
          const c = string.charCodeAt(n);
          if (c < 128) {
            utftext += String.fromCharCode(c);
          } else if ((c > 127) && (c < 2048)) {
            utftext += String.fromCharCode((c >> 6) | 192);
            utftext += String.fromCharCode((c & 63) | 128);
          } else {
            utftext += String.fromCharCode((c >> 12) | 224);
            utftext += String.fromCharCode(((c >> 6) & 63) | 128);
            utftext += String.fromCharCode((c & 63) | 128);
          }
        }
        return utftext;
      }

      let x = [];
      let k, AA, BB, CC, DD, a, b, c, d;
      const S11 = 7, S12 = 12, S13 = 17, S14 = 22;
      const S21 = 5, S22 = 9, S23 = 14, S24 = 20;
      const S31 = 4, S32 = 11, S33 = 16, S34 = 23;
      const S41 = 6, S42 = 10, S43 = 15, S44 = 21;

      string = utf8Encode(string);
      x = convertToWordArray(string);

      a = 0x67452301;
      b = 0xEFCDAB89;
      c = 0x98BADCFE;
      d = 0x10325476;

      const xl = x.length;
      for (k = 0; k < xl; k += 16) {
        AA = a; BB = b; CC = c; DD = d;

        a = FF(a, b, c, d, x[k + 0], S11, 0xD76AA478);
        d = FF(d, a, b, c, x[k + 1], S12, 0xE8C7B756);
        c = FF(c, d, a, b, x[k + 2], S13, 0x242070DB);
        b = FF(b, c, d, a, x[k + 3], S14, 0xC1BDCEEE);
        a = FF(a, b, c, d, x[k + 4], S11, 0xF57C0FAF);
        d = FF(d, a, b, c, x[k + 5], S12, 0x4787C62A);
        c = FF(c, d, a, b, x[k + 6], S13, 0xA8304613);
        b = FF(b, c, d, a, x[k + 7], S14, 0xFD469501);
        a = FF(a, b, c, d, x[k + 8], S11, 0x698098D8);
        d = FF(d, a, b, c, x[k + 9], S12, 0x8B44F7AF);
        c = FF(c, d, a, b, x[k + 10], S13, 0xFFFF5BB1);
        b = FF(b, c, d, a, x[k + 11], S14, 0x895CD7BE);
        a = FF(a, b, c, d, x[k + 12], S11, 0x6B901122);
        d = FF(d, a, b, c, x[k + 13], S12, 0xFD987193);
        c = FF(c, d, a, b, x[k + 14], S13, 0xA679438E);
        b = FF(b, c, d, a, x[k + 15], S14, 0x49B40821);

        a = GG(a, b, c, d, x[k + 1], S21, 0xF61E2562);
        d = GG(d, a, b, c, x[k + 6], S22, 0xC040B340);
        c = GG(c, d, a, b, x[k + 11], S23, 0x265E5A51);
        b = GG(b, c, d, a, x[k + 0], S24, 0xE9B6C7AA);
        a = GG(a, b, c, d, x[k + 5], S21, 0xD62F105D);
        d = GG(d, a, b, c, x[k + 10], S22, 0x2441453);
        c = GG(c, d, a, b, x[k + 15], S23, 0xD8A1E681);
        b = GG(b, c, d, a, x[k + 4], S24, 0xE7D3FBC8);
        a = GG(a, b, c, d, x[k + 9], S21, 0x21E1CDE6);
        d = GG(d, a, b, c, x[k + 14], S22, 0xC33707D6);
        c = GG(c, d, a, b, x[k + 3], S23, 0xF4D50D87);
        b = GG(b, c, d, a, x[k + 8], S24, 0x455A14ED);
        a = GG(a, b, c, d, x[k + 13], S21, 0xA9E3E905);
        d = GG(d, a, b, c, x[k + 2], S22, 0xFCEFA3F8);
        c = GG(c, d, a, b, x[k + 7], S23, 0x676F02D9);
        b = GG(b, c, d, a, x[k + 12], S24, 0x8D2A4C8A);

        a = HH(a, b, c, d, x[k + 5], S31, 0xFFFA3942);
        d = HH(d, a, b, c, x[k + 8], S32, 0x8771F681);
        c = HH(c, d, a, b, x[k + 11], S33, 0x6D9D6122);
        b = HH(b, c, d, a, x[k + 14], S34, 0xFDE5380C);
        a = HH(a, b, c, d, x[k + 1], S31, 0xA4BEEA44);
        d = HH(d, a, b, c, x[k + 4], S32, 0x4BDECFA9);
        c = HH(c, d, a, b, x[k + 7], S33, 0xF6BB4B60);
        b = HH(b, c, d, a, x[k + 10], S34, 0xBEBFBC70);
        a = HH(a, b, c, d, x[k + 13], S31, 0x289B7EC6);
        d = HH(d, a, b, c, x[k + 0], S32, 0xEAA127FA);
        c = HH(c, d, a, b, x[k + 3], S33, 0xD4EF3085);
        b = HH(b, c, d, a, x[k + 6], S34, 0x4881D05);
        a = HH(a, b, c, d, x[k + 9], S31, 0xD9D4D039);
        d = HH(d, a, b, c, x[k + 12], S32, 0xE6DB99E5);
        c = HH(c, d, a, b, x[k + 15], S33, 0x1FA27CF8);
        b = HH(b, c, d, a, x[k + 2], S34, 0xC4AC5665);

        a = II(a, b, c, d, x[k + 0], S41, 0xF4292244);
        d = II(d, a, b, c, x[k + 7], S42, 0x432AFF97);
        c = II(c, d, a, b, x[k + 14], S43, 0xAB9423A7);
        b = II(b, c, d, a, x[k + 5], S44, 0xFC93A039);
        a = II(a, b, c, d, x[k + 12], S41, 0x655B59C3);
        d = II(d, a, b, c, x[k + 3], S42, 0x8F0CCC92);
        c = II(c, d, a, b, x[k + 10], S43, 0xFFEFF47D);
        b = II(b, c, d, a, x[k + 1], S44, 0x85845DD1);
        a = II(a, b, c, d, x[k + 8], S41, 0x6FA87E4F);
        d = II(d, a, b, c, x[k + 15], S42, 0xFE2CE6E0);
        c = II(c, d, a, b, x[k + 6], S43, 0xA3014314);
        b = II(b, c, d, a, x[k + 13], S44, 0x4E0811A1);
        a = II(a, b, c, d, x[k + 4], S41, 0xF7537E82);
        d = II(d, a, b, c, x[k + 11], S42, 0xBD3AF235);
        c = II(c, d, a, b, x[k + 2], S43, 0x2AD7D2BB);
        b = II(b, c, d, a, x[k + 9], S44, 0xEB86D391);

        a = addUnsigned(a, AA);
        b = addUnsigned(b, BB);
        c = addUnsigned(c, CC);
        d = addUnsigned(d, DD);
      }

      const temp = wordToHex(a) + wordToHex(b) + wordToHex(c) + wordToHex(d);
      return temp.toLowerCase();
    }

    function wordToHex(value) {
      let hex = "", byte;
      for (let i = 0; i <= 3; i++) {
        byte = (value >>> (i * 8)) & 255;
        hex += ("0" + byte.toString(16)).slice(-2);
      }
      return hex;
    }

    async function generateHash(algorithm) {
      const input = document.getElementById('hash-input').value;
      const result = document.getElementById('hash-results');

      if (!input) {
        result.innerHTML = '<div class="error">Please enter text to hash</div>';
        return;
      }

      try {
        let hash;

        if (algorithm === 'MD5') {
          hash = MD5(input);
        } else {
          const encoder = new TextEncoder();
          const data = encoder.encode(input);
          const hashBuffer = await crypto.subtle.digest(algorithm, data);
          const hashArray = Array.from(new Uint8Array(hashBuffer));
          hash = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        result.innerHTML += `
          <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; margin-bottom: 0.5rem; position: relative; padding-right: 4rem;">
            <strong>${algorithm}:</strong><br>
            <code style="word-break: break-all;">${hash}</code>
            <button class="copy-btn" onclick="copyToClipboard('${hash}', this)">Copy</button>
          </div>
        `;
      } catch (e) {
        result.innerHTML = '<div class="error">Hash generation failed: ' + e.message + '</div>';
      }
    }

    function clearHash() {
      document.getElementById('hash-input').value = '';
      document.getElementById('hash-results').innerHTML = '';
    }

    // ==================== QR Code Generator ====================
    let qrCodeLib = null;

    async function loadQRCodeLib() {
      if (qrCodeLib) return;

      return new Promise((resolve, reject) => {
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js';
        script.onload = () => {
          qrCodeLib = window.qrcode;
          resolve();
        };
        script.onerror = () => reject(new Error('Failed to load QR code library'));
        document.head.appendChild(script);
      });
    }

    async function generateQRCode() {
      const text = document.getElementById('qr-text').value;
      if (!text) {
        alert('Please enter content to generate QR code');
        return;
      }

      try {
        await loadQRCodeLib();

        // Create QR code object
        const typeNumber = 0; // Auto-determine
        const errorCorrectionLevel = 'M'; // L, M, Q, H
        const qr = qrCodeLib(typeNumber, errorCorrectionLevel);
        qr.addData(text);
        qr.make();

        const canvas = document.getElementById('qr-canvas');
        const cellSize = 8;
        const margin = 2;
        const size = qr.getModuleCount();

        canvas.width = (size + margin * 2) * cellSize;
        canvas.height = (size + margin * 2) * cellSize;

        const ctx = canvas.getContext('2d');

        // White background
        ctx.fillStyle = '#FFFFFF';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Black modules
        ctx.fillStyle = '#000000';
        for (let row = 0; row < size; row++) {
          for (let col = 0; col < size; col++) {
            if (qr.isDark(row, col)) {
              ctx.fillRect(
                (col + margin) * cellSize,
                (row + margin) * cellSize,
                cellSize,
                cellSize
              );
            }
          }
        }
      } catch (e) {
        console.error('QR Code Error:', e);
        alert('QR code generation failed: ' + (e.message || String(e)));
      }
    }

    function downloadQR() {
      const canvas = document.getElementById('qr-canvas');
      if (!canvas.width) {
        alert('Please generate QR code first');
        return;
      }

      const link = document.createElement('a');
      link.download = 'qrcode.png';
      link.href = canvas.toDataURL();
      link.click();
    }

    function clearQR() {
      document.getElementById('qr-text').value = '';
      const canvas = document.getElementById('qr-canvas');
      canvas.width = 0;
      canvas.height = 0;
    }

    // ==================== QR Code Decoder ====================
    let jsQRLib = null;

    async function loadJsQR() {
      if (jsQRLib) return;

      return new Promise((resolve, reject) => {
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js';
        script.onload = () => {
          jsQRLib = window.jsQR;
          resolve();
        };
        script.onerror = reject;
        document.head.appendChild(script);
      });
    }

    async function decodeQRCode(event) {
      const file = event.target.files[0];
      if (!file) return;

      const result = document.getElementById('qr-decode-result');
      result.innerHTML = '<div>Decoding...</div>';

      try {
        await loadJsQR();

        const img = new Image();
        img.onload = () => {
          const canvas = document.createElement('canvas');
          canvas.width = img.width;
          canvas.height = img.height;

          const ctx = canvas.getContext('2d');
          ctx.drawImage(img, 0, 0);

          const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
          const code = jsQRLib(imageData.data, imageData.width, imageData.height);

          if (code) {
            result.innerHTML = `
              <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; position: relative; padding-right: 4rem;">
                <strong>Decoded Result:</strong><br>
                <code style="word-break: break-all;">${escapeHTML(code.data)}</code>
                <button class="copy-btn" onclick="copyToClipboard('${escapeHTML(code.data)}', this)">Copy</button>
              </div>
            `;
          } else {
            result.innerHTML = '<div class="error">Could not recognize QR code, please ensure the image is clear and contains a valid QR code</div>';
          }
        };

        img.src = URL.createObjectURL(file);
      } catch (e) {
        result.innerHTML = '<div class="error">Decoding failed: ' + e.message + '</div>';
      }
    }

    // ==================== Regular Expression Tool ====================
    const regexPresets = {
      email: { pattern: '^[\\w.-]+@[\\w.-]+\\.\\w+$', flags: 'i' },
      phone: { pattern: '^1[3-9]\\d{9}$', flags: '' },
      url: { pattern: '^https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_\\+.~#?&//=]*)$', flags: 'i' },
      ip: { pattern: '^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$', flags: '' },
      date: { pattern: '^\\d{4}-\\d{2}-\\d{2}$', flags: '' },
      number: { pattern: '^-?\\d+(\\.\\d+)?$', flags: '' },
      hex: { pattern: '^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$', flags: 'i' },
      chinese: { pattern: '[\\u4e00-\\u9fa5]+', flags: 'g' }
    };

    function applyRegexPreset() {
      const select = document.getElementById('regex-presets');
      const preset = regexPresets[select.value];
      if (!preset) return;

      document.getElementById('regex-pattern').value = preset.pattern;
      document.getElementById('regex-flag-g').checked = preset.flags.includes('g');
      document.getElementById('regex-flag-i').checked = preset.flags.includes('i');
      document.getElementById('regex-flag-m').checked = preset.flags.includes('m');
    }

    function testRegex() {
      const pattern = document.getElementById('regex-pattern').value;
      const text = document.getElementById('regex-text').value;
      const result = document.getElementById('regex-result');

      if (!pattern) {
        result.innerHTML = '<div class="error">Please enter a regular expression</div>';
        return;
      }

      try {
        const flags =
          (document.getElementById('regex-flag-g').checked ? 'g' : '') +
          (document.getElementById('regex-flag-i').checked ? 'i' : '') +
          (document.getElementById('regex-flag-m').checked ? 'm' : '');

        const regex = new RegExp(pattern, flags);
        const matches = [...text.matchAll(new RegExp(pattern, flags + 'g'))];

        if (matches.length === 0) {
          result.innerHTML = '<div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px;">No matches found</div>';
          return;
        }

        let highlightedText = text;
        matches.reverse().forEach(match => {
          const start = match.index;
          const end = start + match[0].length;
          highlightedText =
            highlightedText.substring(0, start) +
            '<span class="regex-highlight">' + highlightedText.substring(start, end) + '</span>' +
            highlightedText.substring(end);
        });

        let html = `
          <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
            <strong>Matches (${matches.length}):</strong><br>
            <div style="margin-top: 0.5rem; white-space: pre-wrap;">${highlightedText}</div>
          </div>
        `;

        matches.forEach((match, i) => {
          html += `<div style="background: var(--bg-secondary); padding: 0.5rem 1rem; border-radius: 8px; margin-bottom: 0.5rem;">`;
          html += `<strong>Match ${i + 1}:</strong> ${escapeHTML(match[0])}`;
          if (match.length > 1) {
            html += `<br><strong>Capture Groups:</strong> ${match.slice(1).map(g => escapeHTML(g || '')).join(', ')}`;
          }
          html += `</div>`;
        });

        result.innerHTML = html;
      } catch (e) {
        result.innerHTML = '<div class="error">Regex error: ' + e.message + '</div>';
      }
    }

    function regexReplace() {
      const pattern = document.getElementById('regex-pattern').value;
      const text = document.getElementById('regex-text').value;
      const result = document.getElementById('regex-result');

      if (!pattern) {
        result.innerHTML = '<div class="error">Please enter a regular expression</div>';
        return;
      }

      const replacement = prompt('Enter replacement text:', '');
      if (replacement === null) return;

      try {
        const flags =
          (document.getElementById('regex-flag-g').checked ? 'g' : '') +
          (document.getElementById('regex-flag-i').checked ? 'i' : '') +
          (document.getElementById('regex-flag-m').checked ? 'm' : '');

        const regex = new RegExp(pattern, flags);
        const replaced = text.replace(regex, replacement);

        result.innerHTML = `
          <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
            <strong>Replaced Text:</strong><br>
            <div style="margin-top: 0.5rem; white-space: pre-wrap;">${escapeHTML(replaced)}</div>
          </div>
        `;
      } catch (e) {
        result.innerHTML = '<div class="error">Regex error: ' + e.message + '</div>';
      }
    }

    function clearRegex() {
      document.getElementById('regex-pattern').value = '';
      document.getElementById('regex-text').value = '';
      document.getElementById('regex-result').innerHTML = '';
      document.getElementById('regex-presets').value = '';
    }

    // ==================== Color Converter ====================
    function hexToRgb(hex) {
      hex = hex.replace('#', '');
      if (hex.length === 3) {
        hex = hex.split('').map(c => c + c).join('');
      }
      const r = parseInt(hex.substr(0, 2), 16);
      const g = parseInt(hex.substr(2, 2), 16);
      const b = parseInt(hex.substr(4, 2), 16);
      return { r, g, b };
    }

    function rgbToHex(r, g, b) {
      return '#' + [r, g, b].map(x => {
        const hex = x.toString(16);
        return hex.length === 1 ? '0' + hex : hex;
      }).join('');
    }

    function rgbToHsl(r, g, b) {
      r /= 255;
      g /= 255;
      b /= 255;

      const max = Math.max(r, g, b);
      const min = Math.min(r, g, b);
      let h, s, l = (max + min) / 2;

      if (max === min) {
        h = s = 0;
      } else {
        const d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);

        switch (max) {
          case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
          case g: h = ((b - r) / d + 2) / 6; break;
          case b: h = ((r - g) / d + 4) / 6; break;
        }
      }

      return {
        h: Math.round(h * 360),
        s: Math.round(s * 100),
        l: Math.round(l * 100)
      };
    }

    function hslToRgb(h, s, l) {
      h /= 360;
      s /= 100;
      l /= 100;

      let r, g, b;

      if (s === 0) {
        r = g = b = l;
      } else {
        const hue2rgb = (p, q, t) => {
          if (t < 0) t += 1;
          if (t > 1) t -= 1;
          if (t < 1/6) return p + (q - p) * 6 * t;
          if (t < 1/2) return q;
          if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
          return p;
        };

        const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
        const p = 2 * l - q;

        r = hue2rgb(p, q, h + 1/3);
        g = hue2rgb(p, q, h);
        b = hue2rgb(p, q, h - 1/3);
      }

      return {
        r: Math.round(r * 255),
        g: Math.round(g * 255),
        b: Math.round(b * 255)
      };
    }

    function updateColorDisplay(r, g, b) {
      const preview = document.getElementById('color-preview');
      preview.style.background = `rgb(${r}, ${g}, ${b})`;

      const hex = rgbToHex(r, g, b);
      const hsl = rgbToHsl(r, g, b);

      document.getElementById('color-hex').value = hex;
      document.getElementById('color-rgb').value = `rgb(${r}, ${g}, ${b})`;
      document.getElementById('color-hsl').value = `hsl(${hsl.h}, ${hsl.s}%, ${hsl.l}%)`;
    }

    function convertFromHex() {
      const hex = document.getElementById('color-hex').value.trim();
      try {
        const rgb = hexToRgb(hex);
        updateColorDisplay(rgb.r, rgb.g, rgb.b);
      } catch (e) {
        alert('Invalid HEX color value');
      }
    }

    function convertFromRGB() {
      const rgb = document.getElementById('color-rgb').value.trim();
      const match = rgb.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);
      if (match) {
        updateColorDisplay(parseInt(match[1]), parseInt(match[2]), parseInt(match[3]));
      } else {
        alert('Invalid RGB color value, format: rgb(255, 87, 51)');
      }
    }

    function convertFromHSL() {
      const hsl = document.getElementById('color-hsl').value.trim();
      const match = hsl.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);
      if (match) {
        const rgb = hslToRgb(parseInt(match[1]), parseInt(match[2]), parseInt(match[3]));
        updateColorDisplay(rgb.r, rgb.g, rgb.b);
      } else {
        alert('Invalid HSL color value, format: hsl(9, 100%, 60%)');
      }
    }

    function clearColor() {
      document.getElementById('color-hex').value = '';
      document.getElementById('color-rgb').value = '';
      document.getElementById('color-hsl').value = '';
      document.getElementById('color-preview').style.background = '';
    }

    // ==================== Base Converter ====================
    function convertBase() {
      const input = document.getElementById('base-input').value.trim();
      const fromBase = parseInt(document.getElementById('base-from').value);
      const result = document.getElementById('base-results');

      if (!input) {
        result.innerHTML = '<div class="error">Please enter a number</div>';
        return;
      }

      try {
        const decimal = parseInt(input, fromBase);

        if (isNaN(decimal)) {
          result.innerHTML = '<div class="error">Invalid number input</div>';
          return;
        }

        result.innerHTML = `
          <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
            <div style="margin-bottom: 0.5rem;"><strong>Binary:</strong> ${decimal.toString(2)}</div>
            <div style="margin-bottom: 0.5rem;"><strong>Octal:</strong> ${decimal.toString(8)}</div>
            <div style="margin-bottom: 0.5rem;"><strong>Decimal:</strong> ${decimal.toString(10)}</div>
            <div><strong>Hexadecimal:</strong> ${decimal.toString(16).toUpperCase()}</div>
          </div>
        `;
      } catch (e) {
        result.innerHTML = '<div class="error">Conversion failed: ' + e.message + '</div>';
      }
    }

    function clearBase() {
      document.getElementById('base-input').value = '';
      document.getElementById('base-results').innerHTML = '';
    }
  </script>
</body>
</html>
